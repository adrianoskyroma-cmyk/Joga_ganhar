

name: Build APK

on:

push:

branches: [ main, master ]

workflow_dispatch:

jobs:

build:

runs-on: ubuntu-latest


steps:

- uses: actions/checkout@v3


- name: Setup Node.js

uses: actions/setup-node@v3

with:

node-version: '20'


- name: Setup Java

uses: actions/setup-java@v3

with:

distribution: 'temurin'

java-version: '17'


- name: Install dependencies

run: |

cd frontend

yarn install


- name: Build React App

run: |

cd frontend

GENERATE_SOURCEMAP=false yarn build


- name: Sync Capacitor

run: |

cd frontend

npx cap sync android


- name: Build APK

run: |

cd frontend/android

chmod +x gradlew

./gradlew assembleDebug


- name: Upload APK

uses: actions/upload-artifact@v3

with:

name: jogar-ganhar-apk

path: frontend/android/app/build/outputs/apk/debug/app-debug.apk


- name: Create Release

uses: softprops/action-gh-release@v1

if: startsWith(github.ref, 'refs/tags/')

with:

files: frontend/android/app/build/outputs/apk/debug/app-debug.apk

env:

GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

```
